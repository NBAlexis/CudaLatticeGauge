\subsection{\label{sec:GaugeFixing}Gauge Fixing}

\subsubsection{\label{sec:FFT}Introduction of FFT before start}

A brief introduction of FFT.

\textbf{\index{FFT}FFT} is to calculate Discrete Fourier Transform~(DFT), in 1D, it is
\begin{equation}
\begin{split}
&\tilde{x}_m=\sum _n x_nW_N^{mn}\\
&W_N^j\equiv \exp (-i\frac{2\pi j}{N})\\
\end{split}
\end{equation}

\begin{itemize}
  \item Cooley-Tukey mapping
\end{itemize}

Let $N=N_1\times N_2$, we first calculate DFT of subset $I_{n_1}=\{n_2N_1+n_1\}$, such that
\begin{equation}
\begin{split}
&\tilde{x}_m=\sum _{n_1} S_{n_1},\;\;S_{n_1}=\sum _{n_2}x_{n_2N_1+n_1}W_N^{m(n_2N_1+n_1)}\\
\end{split}
\end{equation}
Note that, $S_{n_1}$ can be further factorized as
\begin{equation}
\begin{split}
&\tilde{x}_m=\sum _{n_1} W_N^{mn_1}S'_{n_1},\;\;S'_{n_1}=\sum _{n_2}x_{n_2N_1+n_1}W_N^{mn_2N_1}\\
\end{split}
\end{equation}
then, note that, $N$ can be divided by $N_1$ (the result is $N_2$), so $W_N^{mn_2N_1}=W_{N_2}^{mn_2}$, so $S'$ is just DFT of subset $I_{n_1}$. Then, we can also decompose
\begin{equation}
\begin{split}
&m=m_1N_{\textcolor[rgb]{1,0,0}{2}}+m_2\\
\end{split}
\end{equation}
to write
\begin{equation}
\begin{split}
&\tilde{x}_{m_1N_2+m_2}=\sum _{n_1} W_N^{n_1(m_1N_2+m_2)}S'_{n_1}=\sum _{n_1} W_{N_1}^{n_1m_1}W_N^{n_1m_2}S'_{n_1}\\
\end{split}
\end{equation}
The $W_N^{n_1m_2}$ is twiddle factor, after `twiddle', $S^{''}_{n_1}=W_N^{n_1m_2}S'_{n_1}$, the result is again a DFT with size $N_1$
\begin{equation}
\begin{split}
&\tilde{x}_{m_1N_2+m_2}=\sum _{n_1} W_{N_1}^{n_1m_1}S^{''}_{n_1}\\
\end{split}
\end{equation}

The FFT is implemented in cuFFT, \textbf{We may use a batched 3D cuFFT and a batched 1D cuFFT to implement 4D FFT.}

\subsubsection{\label{sec:CornellGaugeFixing}Cornell Gauge Fixing and FFT accelerated}

The Cornell Gauge Fixing is the steepest descend gauge fixing. The \textbf{\index{Landau Gauge}Landau Gauge} for example. The Landau gauge needs $\partial _{\mu}A_{\mu}=0$. One finds that if
\begin{equation}
\begin{split}
&F(A)=\sum _n{\rm tr}\left[A_{\mu}^2(n)\right]\\
\end{split}
\end{equation}
is minimized, which means $\partial _{\mu}F(A)=0$, and leads to $\partial _{\mu}A_{\mu}=0$. In other words, the Landau gauge fixing is to find the minimum of $F(A)$ (using steepest descend method).

The steepest descend method can be simply described as
\begin{equation}
\begin{split}
&x_{n+1}\to x_n - \alpha \left.\frac{d f(x)}{dx}\right|_{x=x_n}
\end{split}
\end{equation}
where $x$ is a vector, and $x_n$ means iteration for n-times, $\alpha$ is a tunable parameter.

\subsubsection{\label{sec:LosAlamos}Los Alamos Gauge Fixing and over relaxation} 

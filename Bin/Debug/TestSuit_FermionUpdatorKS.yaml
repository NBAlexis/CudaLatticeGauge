
TestFermionUpdatorKS:

    Dim : 4
    Dir : 4
    LatticeLength : [4, 4, 4, 8]
    LatticeIndex : CIndexSquare
    LatticeBoundary : CBoundaryConditionTorusSquare
    ThreadAutoDecompose : 1
    RandomType : ER_Schrage
    RandomSeed : 1234567
    ActionListLength : 2
    FermionFieldCount : 1
    MeasureListLength : 1

    SkipThermalDebug : 0
    BeforeMetropolis : 5
    BeforeMetropolisDebug : 2
    Metropolis : 10
    MetropolisDebug : 4
    ExpectMiss : 1
    ExpectMissDebug : 1
    ExpectedRes : [0.420549]
    ExpectedResDebug : [0.420549]

    Updator:

        ## UpdatorType = { CHMC }
        UpdatorType : CHMC

        Metropolis : 1
        
        ## Will only read this when updator is HMC IntegratorType = { CIntegratorLeapFrog, CIntegratorOmelyan }
        IntegratorType : CIntegratorLeapFrog
        IntegratorStepLength : 1
        IntegratorStep : 60

    Gauge:
    
        FieldName : CFieldGaugeSU3
        FieldInitialType : EFIT_Random
        
    FermionField1:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        Mass : 0.1
        FieldId : 2
        PoolNumber : 15

        Period : [1, 1, 1, -1]
        MC : [1.5312801946347594, -0.0009470074905847408, -0.022930177968879067, -1.1924853242121976, 0.005144532232063027, 0.07551561111396377, 1.3387944865990085]
        MD : [0.39046039002765764, 0.05110937758016059, 0.14082862345293307, 0.5964845035452038, 0.0012779192856479133, 0.028616544606685487, 0.41059997211142607]
        EN : [0.6530478708579666, 0.00852837235258859, 0.05154361612777617, 0.4586723601896008, 0.0022408218960485566, 0.039726885022656366, 0.5831433967066838]

    Solver:

        SolverName : CSLASolverGMRES
        SolverForFieldId : 2
        MaxDim : 20
        Accuracy : 0.0001
        Restart : 15
        AbsoluteAccuracy : 1

    MSSolver:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 2
        DiviationStep : 100
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.001
        AbsoluteAccuracy : 1

    Action1:
   
        ActionName : CActionGaugePlaquette
        Beta : 5.0

    Action2:

        ActionName : CActionFermionKS
        FieldId : 2
        ## MultiStep : 2

    Measure1:

        MeasureName : CMeasurePlaqutteEnergy

TestFermionUpdatorKSNestedForceGradient:

    Dim : 4
    Dir : 4
    LatticeLength : [4, 4, 4, 8]
    LatticeIndex : CIndexSquare
    LatticeBoundary : CBoundaryConditionTorusSquare
    ThreadAutoDecompose : 1
    RandomType : ER_Schrage
    RandomSeed : 1234567
    ActionListLength : 2
    FermionFieldCount : 1
    MeasureListLength : 1

    SkipThermalDebug : 0
    BeforeMetropolis : 5
    BeforeMetropolisDebug : 2
    Metropolis : 10
    MetropolisDebug : 4
    ExpectMiss : 1
    ExpectMissDebug : 1
    ExpectedRes : [0.417654]
    ExpectedResDebug : [0.417654]

    Updator:

        ## UpdatorType = { CHMC }
        UpdatorType : CHMC

        Metropolis : 1
        
        ## Will only read this when updator is HMC IntegratorType = { CIntegratorLeapFrog, CIntegratorOmelyan }
        IntegratorType : CIntegratorNestedForceGradient
        IntegratorStepLength : 1
        IntegratorStep : 8
        NestedStep : 8

    Gauge:
    
        FieldName : CFieldGaugeSU3
        FieldInitialType : EFIT_Random
        
    FermionField1:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        Mass : 0.2
        FieldId : 2
        PoolNumber : 15

        Period : [1, 1, 1, -1]
        MC : [1.5312801946347594, -0.0009470074905847408, -0.022930177968879067, -1.1924853242121976, 0.005144532232063027, 0.07551561111396377, 1.3387944865990085]
        MD : [0.39046039002765764, 0.05110937758016059, 0.14082862345293307, 0.5964845035452038, 0.0012779192856479133, 0.028616544606685487, 0.41059997211142607]
        EN : [0.6530478708579666, 0.00852837235258859, 0.05154361612777617, 0.4586723601896008, 0.0022408218960485566, 0.039726885022656366, 0.5831433967066838]

    Solver:

        SolverName : CSLASolverGMRES
        SolverForFieldId : 2
        MaxDim : 20
        Accuracy : 0.0001
        Restart : 15
        AbsoluteAccuracy : 1

    MSSolver:

        SolverName : CMultiShiftFOM
        SolverForFieldId : 2
        ## cuda is even slower...
        UseCudaForSmallMatrix : 0
        ## Check Accuracy every DiviationStep steps
        MaxDim : 30
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.01
        Restart : 100
        ## 0 is recommanded
        AbsoluteAccuracy : 1

    Action1:
   
        ActionName : CActionGaugePlaquette
        Beta : 5.0

    Action2:

        ActionName : CActionFermionKS
        FieldId : 2
        ## MultiStep : 2

    Measure1:

        MeasureName : CMeasurePlaqutteEnergy

TestFermionUpdatorKSNestedForceGradientNf2p1:

    Dim : 4
    Dir : 4
    LatticeLength : [4, 4, 4, 8]
    LatticeIndex : CIndexSquare
    LatticeBoundary : CBoundaryConditionTorusSquare
    ThreadAutoDecompose : 1
    RandomType : ER_Schrage
    RandomSeed : 1234567
    ActionListLength : 3
    FermionFieldCount : 2
    MeasureListLength : 1

    SkipThermalDebug : 0
    BeforeMetropolis : 5
    BeforeMetropolisDebug : 2
    Metropolis : 10
    MetropolisDebug : 4
    ExpectMiss : 1
    ExpectMissDebug : 1
    ExpectedRes : [0.42]
    ExpectedResDebug : [873.033691]

    Updator:

        ## UpdatorType = { CHMC }
        UpdatorType : CHMC
        DebugForce : 0
        Metropolis : 1
        
        ## Will only read this when updator is HMC IntegratorType = { CIntegratorLeapFrog, CIntegratorOmelyan }
        ## It shows that nested force gradient is worse than Omelyan...
        IntegratorType : CIntegratorMultiLevelNestedForceGradient
        InnerLeapfrog : 1
        IntegratorStepLength : 1
        IntegratorStep : 10
        NestedSteps : [4, 2]
        NestedActionList0 : [2]
        NestedActionList1 : [1]
        NestedActionList2 : [0]

    Gauge:
    
        FieldName : CFieldGaugeSU3
        FieldInitialType : EFIT_Random
        
    FermionField1:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        # 2am
        Mass : 0.1
        FieldId : 2
        PoolNumber : 15

        Period : [1, 1, 1, -1]

        # MC is to prepare
        # This is x^{3/8}
        MC : [1.944188030086476, -0.0007988315916646545, -0.027309084938147772, -2.516685377372154, 0.006150726085176034, 0.08885795057404164, 1.7371507783666744]

        # MD is to calculate force
        # This is x^{-3/4}
        MD : [0.17574830979438497, 0.23527253956849956, 0.22892110007388447, 0.47355809270559934, 0.0005460952413992099, 0.020306856722359847, 0.29483743550120284]

    FermionField2:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        #2am
        Mass : 0.02
        FieldId : 3
        PoolNumber : 15

        Period : [1, 1, 1, -1]

        # MC is to prepare
        # a^2 delta M = 0.0096, this is (x+0.0096/x)^{-1/4}
        MC : [0.9999881240311078, -0.0005149551496446561, -0.0018810650349126727, 0.0014583220237758202, 0.0071163010669864175]

        # MD is to calculate force
        # a^2 delta M = 0.0096, this is (x+0.0096/x)^{1/2}
        MD : [1.0000181158194439, 0.002645611557101056, 0.0021484403702662705, 0.00044249817227846476, 0.004650283535051439]

    Solver:

        SolverName : CSLASolverGMRES
        SolverForFieldId : 2
        MaxDim : 20
        Accuracy : 0.0001
        Restart : 15
        AbsoluteAccuracy : 1

    MSSolver:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 2
        DiviationStep : 100
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.0001
        AbsoluteAccuracy : 1

    MSSolver2:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 3
        DiviationStep : 100
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.0001
        AbsoluteAccuracy : 1

    Action1:
   
        ActionName : CActionGaugePlaquette
        Beta : 5.0

    Action2:

        ActionName : CActionFermionKS
        FieldId : 2

    Action3:

        ActionName : CActionFermionKS
        FieldId : 3

    Measure1:

        MeasureName : CMeasurePlaqutteEnergy

TestFermionUpdatorKSNestedOmelyanNf2p1:

    Dim : 4
    Dir : 4
    LatticeLength : [4, 4, 4, 8]
    LatticeIndex : CIndexSquare
    LatticeBoundary : CBoundaryConditionTorusSquare
    ThreadAutoDecompose : 1
    RandomType : ER_Schrage
    RandomSeed : 1234567
    ActionListLength : 3
    FermionFieldCount : 2
    MeasureListLength : 1

    SkipThermalDebug : 0
    BeforeMetropolis : 5
    BeforeMetropolisDebug : 2
    Metropolis : 10
    MetropolisDebug : 4
    ExpectMiss : 1
    ExpectMissDebug : 1
    ExpectedRes : [0.42]
    ExpectedResDebug : [873.033691]

    Updator:

        ## UpdatorType = { CHMC }
        UpdatorType : CHMC
        # DebugForce : 0
        Metropolis : 1
        
        ## Will only read this when updator is HMC IntegratorType = { CIntegratorLeapFrog, CIntegratorOmelyan }
        IntegratorType : CIntegratorMultiLevelOmelyan
        # It looks like InnerLeapfrog indeed give better result
        InnerLeapfrog : 1
        IntegratorStepLength : 1
        IntegratorStep : 10
        NestedSteps : [4, 2]
        NestedActionList0 : [2]
        NestedActionList1 : [1]
        NestedActionList2 : [0]

    Gauge:
    
        FieldName : CFieldGaugeSU3
        FieldInitialType : EFIT_Random
        
    FermionField1:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        # 2am
        Mass : 0.1
        FieldId : 2
        PoolNumber : 15

        Period : [1, 1, 1, -1]

        # MC is to prepare
        # This is x^{3/8}
        MC : [1.944188030086476, -0.0007988315916646545, -0.027309084938147772, -2.516685377372154, 0.006150726085176034, 0.08885795057404164, 1.7371507783666744]

        # MD is to calculate force
        # This is x^{-3/4}
        MD : [0.17574830979438497, 0.23527253956849956, 0.22892110007388447, 0.47355809270559934, 0.0005460952413992099, 0.020306856722359847, 0.29483743550120284]

    FermionField2:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        #2am
        Mass : 0.02
        FieldId : 3
        PoolNumber : 15

        Period : [1, 1, 1, -1]

        # MC is to prepare
        # 4a^2 delta M = 0.0096, this is (x+0.0096/x)^{-1/4}
        MC : [0.9999881240311078, -0.0005149551496446561, -0.0018810650349126727, 0.0014583220237758202, 0.0071163010669864175]

        # MD is to calculate force
        # 4a^2 delta M = 0.0096, this is (x+0.0096/x)^{1/2}
        MD : [1.0000181158194439, 0.002645611557101056, 0.0021484403702662705, 0.00044249817227846476, 0.004650283535051439]

    Solver:

        SolverName : CSLASolverGMRES
        SolverForFieldId : 2
        MaxDim : 20
        Accuracy : 0.0001
        Restart : 15
        AbsoluteAccuracy : 1

    MSSolver:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 2
        DiviationStep : 100
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.0001
        AbsoluteAccuracy : 1

    MSSolver2:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 3
        DiviationStep : 100
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.0001
        AbsoluteAccuracy : 1

    Action1:
   
        ActionName : CActionGaugePlaquette
        Beta : 5.0

    Action2:

        ActionName : CActionFermionKS
        FieldId : 2

    Action3:

        ActionName : CActionFermionKS
        FieldId : 3

    Measure1:

        MeasureName : CMeasurePlaqutteEnergy

TestFermionUpdatorKSNestedOmelyanNf2p1MultiField:

    Dim : 4
    Dir : 4
    LatticeLength : [4, 4, 4, 8]
    LatticeIndex : CIndexSquare
    LatticeBoundary : CBoundaryConditionTorusSquare
    ThreadAutoDecompose : 1
    RandomType : ER_Schrage
    RandomSeed : 1234567
    ActionListLength : 5
    FermionFieldCount : 4
    MeasureListLength : 1

    SkipThermalDebug : 0
    BeforeMetropolis : 5
    BeforeMetropolisDebug : 2
    Metropolis : 10
    MetropolisDebug : 4
    ExpectMiss : 1
    ExpectMissDebug : 1
    ExpectedRes : [0.444773]
    ExpectedResDebug : [0.444773]

    Updator:

        UpdatorType : CHMC
        Metropolis : 1
        DebugForce : 0
        InnerLeapfrog : 1
        IntegratorType : CIntegratorNestedOmelyan
        IntegratorStepLength : 1
        IntegratorStep : 9
        NestedStep : 5

    Gauge:
    
        FieldName : CFieldGaugeSU3
        FieldInitialType : EFIT_Random
        
    FermionField1:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        # 2am
        Mass : 0.1
        FieldId : 2
        PoolNumber : 15

        Period : [1, 1, 1, -1]

        # MC is to prepare
        # This is x^{1/8}
        MC : [1.2315463126994253, -0.0008278241356180749, -0.014245354429491623, -0.4488176917209997, 0.004266594097242546, 0.0642861314434021, 1.0607522874248192]

        # MD is to calculate force
        # This is x^{-1/4}
        MD : [0.6530478708579666, 0.00852837235258859, 0.05154361612777617, 0.4586723601896008, 0.0022408218960485566, 0.039726885022656366, 0.5831433967066838]

    FermionField2:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        # 2am
        Mass : 0.1
        FieldId : 3
        PoolNumber : 15

        Period : [1, 1, 1, -1]

        # MC is to prepare
        # This is x^{1/8}
        MC : [1.2315463126994253, -0.0008278241356180749, -0.014245354429491623, -0.4488176917209997, 0.004266594097242546, 0.0642861314434021, 1.0607522874248192]

        # MD is to calculate force
        # This is x^{-1/4}
        MD : [0.6530478708579666, 0.00852837235258859, 0.05154361612777617, 0.4586723601896008, 0.0022408218960485566, 0.039726885022656366, 0.5831433967066838]

    FermionField3:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        # 2am
        Mass : 0.1
        FieldId : 4
        PoolNumber : 15

        Period : [1, 1, 1, -1]

        # MC is to prepare
        # This is x^{1/8}
        MC : [1.2315463126994253, -0.0008278241356180749, -0.014245354429491623, -0.4488176917209997, 0.004266594097242546, 0.0642861314434021, 1.0607522874248192]

        # MD is to calculate force
        # This is x^{-1/4}
        MD : [0.6530478708579666, 0.00852837235258859, 0.05154361612777617, 0.4586723601896008, 0.0022408218960485566, 0.039726885022656366, 0.5831433967066838]

    FermionField4:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        #2am
        Mass : 0.02
        FieldId : 5
        PoolNumber : 15

        Period : [1, 1, 1, -1]

        # MC is to prepare
        # 4a^2 delta M = 0.0096, this is (x+0.0096/x)^{-1/4}
        MC : [0.9999881240311078, -0.0005149551496446561, -0.0018810650349126727, 0.0014583220237758202, 0.0071163010669864175]

        # MD is to calculate force
        # 4a^2 delta M = 0.0096, this is (x+0.0096/x)^{1/2}
        MD : [1.0000181158194439, 0.002645611557101056, 0.0021484403702662705, 0.00044249817227846476, 0.004650283535051439]

    Solver:

        SolverName : CSLASolverGMRES
        SolverForFieldId : 2
        MaxDim : 20
        Accuracy : 0.0001
        Restart : 15
        AbsoluteAccuracy : 1

    MSSolver:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 2
        DiviationStep : 100
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.0001
        AbsoluteAccuracy : 1

    MSSolver2:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 3
        DiviationStep : 100
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.0001
        AbsoluteAccuracy : 1

    MSSolver3:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 4
        DiviationStep : 100
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.0001
        AbsoluteAccuracy : 1

    MSSolver4:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 5
        DiviationStep : 100
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.0001
        AbsoluteAccuracy : 1

    Action1:
   
        ActionName : CActionGaugePlaquette
        Beta : 5.0

    Action2:

        ActionName : CActionFermionKS
        FieldId : 2

    Action3:

        ActionName : CActionFermionKS
        FieldId : 3

    Action4:

        ActionName : CActionFermionKS
        FieldId : 4

    Action5:

        ActionName : CActionFermionKS
        FieldId : 5

    Measure1:

        MeasureName : CMeasurePlaqutteEnergy

TestFermionUpdatorKSNestedForceGradientNf2p1MultiField:

    Dim : 4
    Dir : 4
    LatticeLength : [4, 4, 4, 8]
    LatticeIndex : CIndexSquare
    LatticeBoundary : CBoundaryConditionTorusSquare
    ThreadAutoDecompose : 1
    RandomType : ER_Schrage
    RandomSeed : 1234567
    ActionListLength : 5
    FermionFieldCount : 4
    MeasureListLength : 1

    SkipThermalDebug : 0
    BeforeMetropolis : 5
    BeforeMetropolisDebug : 2
    Metropolis : 10
    MetropolisDebug : 4
    ExpectMiss : 1
    ExpectMissDebug : 1
    ExpectedRes : [0.42]
    ExpectedResDebug : [873.033691]

    Updator:

        UpdatorType : CHMC
        Metropolis : 1
        InnerLeapfrog : 1
        IntegratorType : CIntegratorNestedForceGradient
        IntegratorStepLength : 1
        IntegratorStep : 8
        NestedStep : 5

    Gauge:
    
        FieldName : CFieldGaugeSU3
        FieldInitialType : EFIT_Random
        
    FermionField1:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        # 2am
        Mass : 0.1
        FieldId : 2
        PoolNumber : 15

        Period : [1, 1, 1, -1]

        # MC is to prepare
        # This is x^{1/8}
        MC : [1.2315463126994253, -0.0008278241356180749, -0.014245354429491623, -0.4488176917209997, 0.004266594097242546, 0.0642861314434021, 1.0607522874248192]

        # MD is to calculate force
        # This is x^{-1/4}
        MD : [0.6530478708579666, 0.00852837235258859, 0.05154361612777617, 0.4586723601896008, 0.0022408218960485566, 0.039726885022656366, 0.5831433967066838]

    FermionField2:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        # 2am
        Mass : 0.1
        FieldId : 3
        PoolNumber : 15

        Period : [1, 1, 1, -1]

        # MC is to prepare
        # This is x^{1/8}
        MC : [1.2315463126994253, -0.0008278241356180749, -0.014245354429491623, -0.4488176917209997, 0.004266594097242546, 0.0642861314434021, 1.0607522874248192]

        # MD is to calculate force
        # This is x^{-1/4}
        MD : [0.6530478708579666, 0.00852837235258859, 0.05154361612777617, 0.4586723601896008, 0.0022408218960485566, 0.039726885022656366, 0.5831433967066838]

    FermionField3:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        # 2am
        Mass : 0.1
        FieldId : 4
        PoolNumber : 15

        Period : [1, 1, 1, -1]

        # MC is to prepare
        # This is x^{1/8}
        MC : [1.2315463126994253, -0.0008278241356180749, -0.014245354429491623, -0.4488176917209997, 0.004266594097242546, 0.0642861314434021, 1.0607522874248192]

        # MD is to calculate force
        # This is x^{-1/4}
        MD : [0.6530478708579666, 0.00852837235258859, 0.05154361612777617, 0.4586723601896008, 0.0022408218960485566, 0.039726885022656366, 0.5831433967066838]

    FermionField4:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        #2am
        Mass : 0.02
        FieldId : 5
        PoolNumber : 15

        Period : [1, 1, 1, -1]

        # MC is to prepare
        # 4a^2 delta M = 0.0096, this is (x+0.0096/x)^{-1/4}
        MC : [0.9999881240311078, -0.0005149551496446561, -0.0018810650349126727, 0.0014583220237758202, 0.0071163010669864175]

        # MD is to calculate force
        # 4a^2 delta M = 0.0096, this is (x+0.0096/x)^{1/2}
        MD : [1.0000181158194439, 0.002645611557101056, 0.0021484403702662705, 0.00044249817227846476, 0.004650283535051439]

    Solver:

        SolverName : CSLASolverGMRES
        SolverForFieldId : 2
        MaxDim : 20
        Accuracy : 0.0001
        Restart : 15
        AbsoluteAccuracy : 1

    MSSolver:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 2
        DiviationStep : 100
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.0001
        AbsoluteAccuracy : 1

    MSSolver2:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 3
        DiviationStep : 100
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.0001
        AbsoluteAccuracy : 1

    MSSolver3:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 4
        DiviationStep : 100
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.0001
        AbsoluteAccuracy : 1

    MSSolver4:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 5
        DiviationStep : 100
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.0001
        AbsoluteAccuracy : 1

    Action1:
   
        ActionName : CActionGaugePlaquette
        Beta : 5.0

    Action2:

        ActionName : CActionFermionKS
        FieldId : 2

    Action3:

        ActionName : CActionFermionKS
        FieldId : 3

    Action4:

        ActionName : CActionFermionKS
        FieldId : 4

    Action5:

        ActionName : CActionFermionKS
        FieldId : 5

    Measure1:

        MeasureName : CMeasurePlaqutteEnergy

TestFermionUpdatorKSNested11StageNf2p1MultiField:

    Dim : 4
    Dir : 4
    LatticeLength : [4, 4, 4, 8]
    LatticeIndex : CIndexSquare
    LatticeBoundary : CBoundaryConditionTorusSquare
    ThreadAutoDecompose : 1
    RandomType : ER_Schrage
    RandomSeed : 1234567
    ActionListLength : 5
    FermionFieldCount : 4
    MeasureListLength : 1

    SkipThermalDebug : 0
    BeforeMetropolis : 5
    BeforeMetropolisDebug : 2
    Metropolis : 10
    MetropolisDebug : 4
    ExpectMiss : 1
    ExpectMissDebug : 1
    ExpectedRes : [0.42]
    ExpectedResDebug : [873.033691]

    Updator:

        UpdatorType : CHMC
        Metropolis : 1
        DebugForce : 0
        InnerLeapfrog : 1
        IntegratorType : CIntegratorNested11Stage
        IntegratorStepLength : 1
        IntegratorStep : 5
        NestedStep : 10
        Pisition : 0

    Gauge:
    
        FieldName : CFieldGaugeSU3
        FieldInitialType : EFIT_Random
        
    FermionField1:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        # 2am
        Mass : 0.1
        FieldId : 2
        PoolNumber : 15

        Period : [1, 1, 1, -1]

        # MC is to prepare
        # This is x^{1/8}
        MC : [1.2315463126994253, -0.0008278241356180749, -0.014245354429491623, -0.4488176917209997, 0.004266594097242546, 0.0642861314434021, 1.0607522874248192]

        # MD is to calculate force
        # This is x^{-1/4}
        MD : [0.6530478708579666, 0.00852837235258859, 0.05154361612777617, 0.4586723601896008, 0.0022408218960485566, 0.039726885022656366, 0.5831433967066838]

    FermionField2:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        # 2am
        Mass : 0.1
        FieldId : 3
        PoolNumber : 15

        Period : [1, 1, 1, -1]

        # MC is to prepare
        # This is x^{1/8}
        MC : [1.2315463126994253, -0.0008278241356180749, -0.014245354429491623, -0.4488176917209997, 0.004266594097242546, 0.0642861314434021, 1.0607522874248192]

        # MD is to calculate force
        # This is x^{-1/4}
        MD : [0.6530478708579666, 0.00852837235258859, 0.05154361612777617, 0.4586723601896008, 0.0022408218960485566, 0.039726885022656366, 0.5831433967066838]

    FermionField3:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        # 2am
        Mass : 0.1
        FieldId : 4
        PoolNumber : 15

        Period : [1, 1, 1, -1]

        # MC is to prepare
        # This is x^{1/8}
        MC : [1.2315463126994253, -0.0008278241356180749, -0.014245354429491623, -0.4488176917209997, 0.004266594097242546, 0.0642861314434021, 1.0607522874248192]

        # MD is to calculate force
        # This is x^{-1/4}
        MD : [0.6530478708579666, 0.00852837235258859, 0.05154361612777617, 0.4586723601896008, 0.0022408218960485566, 0.039726885022656366, 0.5831433967066838]

    FermionField4:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        #2am
        Mass : 0.02
        FieldId : 5
        PoolNumber : 15

        Period : [1, 1, 1, -1]

        # MC is to prepare
        # 4a^2 delta M = 0.0096, this is (x+0.0096/x)^{-1/4}
        MC : [0.9999881240311078, -0.0005149551496446561, -0.0018810650349126727, 0.0014583220237758202, 0.0071163010669864175]

        # MD is to calculate force
        # 4a^2 delta M = 0.0096, this is (x+0.0096/x)^{1/2}
        MD : [1.0000181158194439, 0.002645611557101056, 0.0021484403702662705, 0.00044249817227846476, 0.004650283535051439]

    Solver:

        SolverName : CSLASolverGMRES
        SolverForFieldId : 2
        MaxDim : 20
        Accuracy : 0.0001
        Restart : 15
        AbsoluteAccuracy : 1

    MSSolver:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 2
        DiviationStep : 100
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.0001
        AbsoluteAccuracy : 1

    MSSolver2:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 3
        DiviationStep : 100
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.0001
        AbsoluteAccuracy : 1

    MSSolver3:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 4
        DiviationStep : 100
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.0001
        AbsoluteAccuracy : 1

    MSSolver4:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 5
        DiviationStep : 100
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.0001
        AbsoluteAccuracy : 1

    Action1:
   
        ActionName : CActionGaugePlaquette
        Beta : 5.0

    Action2:

        ActionName : CActionFermionKS
        FieldId : 2

    Action3:

        ActionName : CActionFermionKS
        FieldId : 3

    Action4:

        ActionName : CActionFermionKS
        FieldId : 4

    Action5:

        ActionName : CActionFermionKS
        FieldId : 5

    Measure1:

        MeasureName : CMeasurePlaqutteEnergy


TestFermionUpdatorWithMesonCorrelatorStaggered:

    Dim : 4
    Dir : 4
    LatticeLength : [4, 4, 4, 8]
    LatticeIndex : CIndexSquare
    LatticeBoundary : CBoundaryConditionTorusSquare
    ThreadAutoDecompose : 1
    RandomType : ER_Schrage
    RandomSeed : 1234567
    ActionListLength : 2
    FermionFieldCount : 1
    MeasureListLength : 2
    ExpectedRes1D : -6.785034
    ExpectedRes2D : 12.458732
    ExpectedRes3D : 0.682366
    ExpectedRes4D : 0.072341
    ExpectedRes1R : 9.957547
    ExpectedRes2R : -24.212927
    ExpectedRes3R : 9.957547
    ExpectedRes4R : -24.212927

    Updator:

        ## UpdatorType = { CHMC }
        UpdatorType : CHMC

        Metropolis : 1
        InnerLeapfrog : 1
        ## Will only read this when updator is HMC IntegratorType = { CIntegratorLeapFrog, CIntegratorOmelyan }
        IntegratorType : CIntegratorNestedForceGradient
        IntegratorStepLength : 1
        IntegratorStep : 10
        NestedStep : 8

    Gauge:
    
        FieldName : CFieldGaugeSU3
        FieldInitialType : EFIT_Random
        
    FermionField1:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        Mass : 0.5
        FieldId : 2
        PoolNumber : 15

        Period : [1, 1, 1, -1]
        MC : [1.5312801946347594, -0.0009470074905847408, -0.022930177968879067, -1.1924853242121976, 0.005144532232063027, 0.07551561111396377, 1.3387944865990085]
        MD : [0.39046039002765764, 0.05110937758016059, 0.14082862345293307, 0.5964845035452038, 0.0012779192856479133, 0.028616544606685487, 0.41059997211142607]
        EN : [0.6530478708579666, 0.00852837235258859, 0.05154361612777617, 0.4586723601896008, 0.0022408218960485566, 0.039726885022656366, 0.5831433967066838]

    Solver:

        SolverName : CSLASolverGMRES
        SolverForFieldId : 2
        MaxDim : 20
        Accuracy : 0.0001
        Restart : 15
        AbsoluteAccuracy : 1

    MSSolver:

        SolverName : CMultiShiftFOM
        SolverForFieldId : 2
        ## cuda is even slower...
        UseCudaForSmallMatrix : 0
        ## Check Accuracy every DiviationStep steps
        MaxDim : 30
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.01
        Restart : 100
        ## 0 is recommanded
        AbsoluteAccuracy : 1

    Action1:
   
        ActionName : CActionGaugePlaquette
        Beta : 5.0

    Action2:

        ActionName : CActionFermionKS
        FieldId : 2
        ## MultiStep : 2

    Measure1:

        MeasureName : CMeasureMesonCorrelatorStaggered
        ShowResult : 1
        GaugeFixing : 1
        # SimpleVersion : 1
        FieldId : 2

    Measure2:

        MeasureName : CMeasureMesonCorrelatorStaggeredSimple
        ShowResult : 1
        FieldId : 2

    GaugeFixing:

        Name : CGaugeFixingCoulombCornell
        Alpha : 0.1
        MaxIterate : 180000
        Accuracy : 0.0001
        FFT : 0


TestFermionUpdatorKSP4:

    Dim : 4
    Dir : 4
    LatticeLength : [4, 4, 4, 8]
    LatticeIndex : CIndexSquare
    LatticeBoundary : CBoundaryConditionTorusSquare
    ThreadAutoDecompose : 1
    RandomType : ER_Schrage
    RandomSeed : 1234567
    ActionListLength : 2
    FermionFieldCount : 1
    MeasureListLength : 1

    SkipThermalDebug : 0
    BeforeMetropolis : 5
    BeforeMetropolisDebug : 2
    Metropolis : 10
    MetropolisDebug : 4
    ExpectMiss : 1
    ExpectMissDebug : 1
    ExpectedRes : [0.239384]
    ExpectedResDebug : [0.239384]

    Updator:

        ## UpdatorType = { CHMC }
        UpdatorType : CHMC

        Metropolis : 1
        
        ## Will only read this when updator is HMC IntegratorType = { CIntegratorLeapFrog, CIntegratorOmelyan }
        IntegratorType : CIntegratorNestedForceGradient
        IntegratorStepLength : 1
        IntegratorStep : 6
        NestedStep : 8
        InnerLeapfrog : 1
        

    Gauge:
    
        FieldName : CFieldGaugeSU3
        FieldInitialType : EFIT_Random
        
    FermionField1:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3P4

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        Mass : 0.5
        FieldId : 2
        PoolNumber : 15

        Period : [1, 1, 1, -1]
        MC : [1.5312801946347594, -0.0009470074905847408, -0.022930177968879067, -1.1924853242121976, 0.005144532232063027, 0.07551561111396377, 1.3387944865990085]
        MD : [0.39046039002765764, 0.05110937758016059, 0.14082862345293307, 0.5964845035452038, 0.0012779192856479133, 0.028616544606685487, 0.41059997211142607]

    Solver:

        SolverName : CSLASolverGMRES
        SolverForFieldId : 2
        MaxDim : 20
        Accuracy : 0.0001
        Restart : 15
        AbsoluteAccuracy : 1

    MSSolver:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 2
        DiviationStep : 10
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.0001
        AbsoluteAccuracy : 1

    Action1:
   
        ActionName : CActionGaugePlaquette
        Beta : 3.0

    Action2:

        ActionName : CActionFermionKS
        FieldId : 2
        ## MultiStep : 2

    Measure1:

        MeasureName : CMeasurePlaqutteEnergy


TestFermionUpdatorKSGamma:

    Dim : 4
    Dir : 4
    LatticeLength : [4, 4, 4, 8]
    LatticeIndex : CIndexSquare
    LatticeBoundary : CBoundaryConditionTorusSquare
    # LatticeBoundary : CBoundaryConditionProjectivePlaneSquare
    ThreadAutoDecompose : 1
    RandomType : ER_Schrage
    RandomSeed : 1234567
    ActionListLength : 2
    FermionFieldCount : 1
    MeasureListLength : 1
    ExpectedResDebug : [0.24]
    ExpectedRes : [0.209288]

    BeforeMetropolis : 3
    BeforeMetropolisDebug : 1
    Metropolis : 10
    MetropolisDebug : 4
    ExpectMiss : 1
    ExpectMissDebug : 1

    Updator:

        ## UpdatorType = { CHMC }
        UpdatorType : CHMC

        Metropolis : 1
        
        ## Will only read this when updator is HMC IntegratorType = { CIntegratorLeapFrog, CIntegratorOmelyan }
        IntegratorType : CIntegratorNestedForceGradient
        IntegratorStepLength : 1
        IntegratorStep : 5
        NestedStep : 8
        InnerLeapfrog : 1
        

    Gauge:
    
        FieldName : CFieldGaugeSU3
        FieldInitialType : EFIT_Random
        
    FermionField1:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3Gamma

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        Mass : 0.5
        FieldId : 2
        PoolNumber : 15

        # EachSiteEta : 1

        Gamma1 : 0.1
        Gamma2 : 0.2
        Gamma3 : 0.3
        Gamma4 : 0.4
        Gamma5 : 0.5
        Gamma15 : 0.15
        Gamma25 : 0.25
        Gamma35 : 0.35
        Gamma45 : 0.45
        Sigma12 : 0.12
        Sigma13 : 0.13
        Sigma14 : 0.14
        Sigma23 : 0.23
        Sigma24 : 0.24
        Sigma34 : 0.34

        Period : [1, 1, 1, -1]
        MC : [1.5312801946347594, -0.0009470074905847408, -0.022930177968879067, -1.1924853242121976, 0.005144532232063027, 0.07551561111396377, 1.3387944865990085]
        MD : [0.39046039002765764, 0.05110937758016059, 0.14082862345293307, 0.5964845035452038, 0.0012779192856479133, 0.028616544606685487, 0.41059997211142607]

    Solver:

        SolverName : CSLASolverGMRES
        SolverForFieldId : 2
        MaxDim : 20
        Accuracy : 0.0001
        Restart : 15
        AbsoluteAccuracy : 1

    MSSolver:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 2
        DiviationStep : 10
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.0001
        AbsoluteAccuracy : 1

    Action1:
   
        ActionName : CActionGaugePlaquette
        Beta : 3.0
        # CloverEnergy : 1

    Action2:

        ActionName : CActionFermionKS
        FieldId : 2
        ## MultiStep : 2

    Measure1:

        MeasureName : CMeasurePlaqutteEnergy

TestFermionUpdatorKSGammaProj:

    Dim : 4
    Dir : 4
    LatticeLength : [4, 4, 4, 8]
    LatticeIndex : CIndexSquare
    # LatticeBoundary : CBoundaryConditionTorusSquare
    LatticeBoundary : CBoundaryConditionProjectivePlaneSquare
    ThreadAutoDecompose : 1
    RandomType : ER_Schrage
    RandomSeed : 1234567
    ActionListLength : 2
    FermionFieldCount : 1
    MeasureListLength : 1
    ExpectedResDebug : [0.24]
    ExpectedRes : [0.209288]

    BeforeMetropolis : 3
    BeforeMetropolisDebug : 1
    Metropolis : 10
    MetropolisDebug : 4
    ExpectMiss : 2
    ExpectMissDebug : 1

    Updator:

        ## UpdatorType = { CHMC }
        UpdatorType : CHMC

        Metropolis : 1
        
        ## Will only read this when updator is HMC IntegratorType = { CIntegratorLeapFrog, CIntegratorOmelyan }
        IntegratorType : CIntegratorNestedForceGradient
        IntegratorStepLength : 1
        IntegratorStep : 5
        NestedStep : 8
        InnerLeapfrog : 1
        

    Gauge:
    
        FieldName : CFieldGaugeSU3
        FieldInitialType : EFIT_Random
        
    FermionField1:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3Gamma

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        Mass : 0.5
        FieldId : 2
        PoolNumber : 15

        EachSiteEta : 1

        Gamma1 : 0.1
        Gamma2 : 0.2
        Gamma3 : 0.3
        Gamma4 : 0.4
        Gamma5 : 0.5
        Gamma15 : 0.15
        Gamma25 : 0.25
        Gamma35 : 0.35
        Gamma45 : 0.45
        # Sigma12 : 0.12
        Sigma13 : 0.13
        Sigma14 : 0.14
        Sigma23 : 0.23
        Sigma24 : 0.24
        Sigma34 : 0.34

        Period : [1, 1, 1, -1]
        MC : [1.5312801946347594, -0.0009470074905847408, -0.022930177968879067, -1.1924853242121976, 0.005144532232063027, 0.07551561111396377, 1.3387944865990085]
        MD : [0.39046039002765764, 0.05110937758016059, 0.14082862345293307, 0.5964845035452038, 0.0012779192856479133, 0.028616544606685487, 0.41059997211142607]

    Solver:

        SolverName : CSLASolverGMRES
        SolverForFieldId : 2
        MaxDim : 20
        Accuracy : 0.0001
        Restart : 15
        AbsoluteAccuracy : 1

    MSSolver:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 2
        DiviationStep : 10
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.0001
        AbsoluteAccuracy : 1

    Action1:
   
        ActionName : CActionGaugePlaquette
        Beta : 3.0
        CloverEnergy : 1

    Action2:

        ActionName : CActionFermionKS
        FieldId : 2
        ## MultiStep : 2

    Measure1:

        MeasureName : CMeasurePlaqutteEnergy


TestFermionUpdatorKSGammaEM:

    Dim : 4
    Dir : 4
    LatticeLength : [4, 4, 4, 8]
    # Center : [2, 2, 0, 0]
    LatticeIndex : CIndexSquare
    LatticeBoundary : CBoundaryConditionTorusSquare
    # LatticeBoundary : CBoundaryConditionProjectivePlaneSquare
    ThreadAutoDecompose : 1
    RandomType : ER_Schrage
    RandomSeed : 1234567
    ActionListLength : 2
    GaugeFieldCount : 2
    FermionFieldCount : 1
    MeasureListLength : 1
    ExpectedResDebug : [0.24]
    ExpectedRes : [0.211636]

    BeforeMetropolis : 3
    BeforeMetropolisDebug : 1
    Metropolis : 10
    MetropolisDebug : 4
    ExpectMiss : 2
    ExpectMissDebug : 1

    Updator:

        ## UpdatorType = { CHMC }
        UpdatorType : CHMC

        Metropolis : 1
        
        ## Will only read this when updator is HMC IntegratorType = { CIntegratorLeapFrog, CIntegratorOmelyan }
        IntegratorType : CIntegratorNestedForceGradient
        IntegratorStepLength : 1
        IntegratorStep : 4
        NestedStep : 8
        InnerLeapfrog : 1
        

    Gauge:
    
        FieldName : CFieldGaugeSU3
        FieldInitialType : EFIT_Random
        
    FermionField1:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3GammaEM

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        Mass : 0.5
        FieldId : 2
        PoolNumber : 15

        # EachSiteEta : 1

        Gamma1 : 0.1
        Gamma2 : 0.2
        Gamma3 : 0.3
        Gamma4 : 0.4
        Gamma5 : 0.5
        Gamma15 : 0.15
        Gamma25 : 0.25
        Gamma35 : 0.35
        Gamma45 : 0.45
        Sigma12 : 0.12
        Sigma13 : 0.13
        Sigma14 : 0.14
        Sigma23 : 0.23
        Sigma24 : 0.24
        Sigma34 : 0.34

        Charge : -0.333333333
        EMFieldID : 3

        Period : [1, 1, 1, -1]
        MC : [1.5312801946347594, -0.0009470074905847408, -0.022930177968879067, -1.1924853242121976, 0.005144532232063027, 0.07551561111396377, 1.3387944865990085]
        MD : [0.39046039002765764, 0.05110937758016059, 0.14082862345293307, 0.5964845035452038, 0.0012779192856479133, 0.028616544606685487, 0.41059997211142607]

    Gauge2:

        FieldName : CFieldGaugeU1Real

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_U1Real
        FieldId : 3
        Period : [1, 1, 1, 1]
        EzType : EURT_E_t
        EzValue : 0.1
        Dynamic : 0

    Solver:

        SolverName : CSLASolverGMRES
        SolverForFieldId : 2
        MaxDim : 20
        Accuracy : 0.0001
        Restart : 15
        AbsoluteAccuracy : 1

    MSSolver:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 2
        DiviationStep : 10
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.0001
        AbsoluteAccuracy : 1

    Action1:
   
        ActionName : CActionGaugePlaquette
        Beta : 3.0
        # CloverEnergy : 1

    Action2:

        ActionName : CActionFermionKS
        FieldId : 2
        ## MultiStep : 2

    Measure1:

        MeasureName : CMeasurePlaqutteEnergy

TestFermionUpdatorKSGammaEMProj:

    Dim : 4
    Dir : 4
    LatticeLength : [4, 4, 4, 8]
    # Center : [2, 2, 0, 0]
    LatticeIndex : CIndexSquare
    # LatticeBoundary : CBoundaryConditionTorusSquare
    LatticeBoundary : CBoundaryConditionProjectivePlaneSquare
    ThreadAutoDecompose : 1
    RandomType : ER_Schrage
    RandomSeed : 1234567
    ActionListLength : 2
    GaugeFieldCount : 2
    FermionFieldCount : 1
    MeasureListLength : 1
    ExpectedResDebug : [0.24]
    ExpectedRes : [0.209035]

    BeforeMetropolis : 3
    BeforeMetropolisDebug : 1
    Metropolis : 10
    MetropolisDebug : 4
    ExpectMiss : 2
    ExpectMissDebug : 1

    Updator:

        ## UpdatorType = { CHMC }
        UpdatorType : CHMC

        Metropolis : 1
        
        ## Will only read this when updator is HMC IntegratorType = { CIntegratorLeapFrog, CIntegratorOmelyan }
        IntegratorType : CIntegratorNestedForceGradient
        IntegratorStepLength : 1
        IntegratorStep : 5
        NestedStep : 8
        InnerLeapfrog : 1
        

    Gauge:
    
        FieldName : CFieldGaugeSU3
        FieldInitialType : EFIT_Random
        
    FermionField1:
        
        ## FieldName = {CFieldFermionWilsonSquareSU3}
        FieldName : CFieldFermionKSSU3GammaEM

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_RandomGaussian

        Mass : 0.5
        FieldId : 2
        PoolNumber : 15

        EachSiteEta : 1

        Gamma1 : 0.1
        Gamma2 : 0.2
        Gamma3 : 0.3
        Gamma4 : 0.4
        Gamma5 : 0.5
        Gamma15 : 0.15
        Gamma25 : 0.25
        Gamma35 : 0.35
        Gamma45 : 0.45
        # Sigma12 : 0.12
        Sigma13 : 0.13
        Sigma14 : 0.14
        Sigma23 : 0.23
        Sigma24 : 0.24
        Sigma34 : 0.34

        Charge : -0.333333333
        EMFieldID : 3

        Period : [1, 1, 1, -1]
        MC : [1.5312801946347594, -0.0009470074905847408, -0.022930177968879067, -1.1924853242121976, 0.005144532232063027, 0.07551561111396377, 1.3387944865990085]
        MD : [0.39046039002765764, 0.05110937758016059, 0.14082862345293307, 0.5964845035452038, 0.0012779192856479133, 0.028616544606685487, 0.41059997211142607]

    Gauge2:

        FieldName : CFieldGaugeU1Real

        ## { EFIT_Zero, EFIT_RandomGaussian }
        FieldInitialType : EFIT_U1Real
        FieldId : 3
        Period : [1, 1, 1, 1]
        ChemicalType : EURT_None
        ChemicalValue : 0.0
        EzType : EURT_E_t
        EzValue : 0.1
        BzType : EURT_Bp_xy
        BzValue : 0.1
        Dynamic : 0

    Solver:

        SolverName : CSLASolverGMRES
        SolverForFieldId : 2
        MaxDim : 20
        Accuracy : 0.0001
        Restart : 15
        AbsoluteAccuracy : 1

    MSSolver:

        SolverName : CMultiShiftBiCGStab
        SolverForFieldId : 2
        DiviationStep : 10
        ## after MaxStep checks (DiviationStep x MaxStep steps) if the Accuracy is not reached, give up
        MaxStep : 50
        ## Can NOT be too small, otherwise, will never reached..
        Accuracy : 0.0001
        AbsoluteAccuracy : 1

    Action1:
   
        ActionName : CActionGaugePlaquette
        Beta : 3.0
        CloverEnergy : 1

    Action2:

        ActionName : CActionFermionKS
        FieldId : 2
        ## MultiStep : 2

    Measure1:

        MeasureName : CMeasurePlaqutteEnergy